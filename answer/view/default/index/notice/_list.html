	<script type="text/javascript" src="view/<{$tplName}>/js/jquery.overall.js"></script>	
	<table class="dbTable">
           <thead>
               <tr>
               <{if $type=='0'}>
               		<th style="width:6%"><a id="select-all" >全选</a></th>
               <{/if}>
               		<th style="width:58%">公告主题</th><th style="width:10%">发布者</th><th style="width:15%">发布时间</th><th>操作</th></tr>
           </thead>
           <tbody>
               <{foreach from=$notice_list item=notice}>
               <tr>
               <{if $type == '0'}>
	            	<td><input type="checkbox" name="nid[]" value="<{$notice.notice_id}>"/></td>
	       <{/if}> 	
               	<td onclick="window.location.href='<{spUrl c=notice a=detail id=$notice.notice_id tid=$tid sid=$sid}>'">
               		
               		<{$notice.title}>
               	</td>
               	<td onclick="window.location.href='<{spUrl c=notice a=detail id=$notice.announce_id tid=$tid sid=$sid}>'"><{$notice.operator_id}></td>
               	<td onclick="window.location.href='<{spUrl c=notice a=detail id=$notice.announce_id tid=$tid sid=$sid}>'"><{$notice.record_time}></td>
               	<td>
               		<a href="<{spUrl c=notice a=detail id=$notice.announce_id tid=$tid sid=$sid}>">查看</a>
               		<{if $operator_id == $notice.operator_id || $class==0}>
	               		<!-- <a href="<{spUrl c=notice a=edit id=$notice.notice_id tid=$tid sid=$sid}>">编辑</a> -->
	               		<a href="javascript:void(0);" onclick="del('<{$notice.announce_id}>','<{$notice.title}>');">删除</a>
	               	<{/if}>	
               	</td>
               </tr>
               <{foreachelse}>
					<tr><td colspan="<{if $type=='0'}>5<{else}>4<{/if}>"><span id="no_record">无查询记录！</span></td></tr>
               <{/foreach}>
           </tbody>
  			<tfoot>
      			<tr><td colspan="<{if $type=='0'}>5<{else}>4<{/if}>">
      			<{if $type=='0'}>
          			<a id="batch-del" title="删除选中公告">批量删除</a>
          		<{/if}>
          			<a href="<{spUrl c=notice a=create tid=$tid sid=$sid}>">发布公告</a>
          		</td></tr>
           	</tfoot>
       </table>
       <{include file="../inc/page.html"}>
       
<script type="text/javascript">
	jQuery(document).ready(function(){
		
		jQuery("#select-all").toggle(function(){
			jQuery('[name="nid[]"]:checkbox').attr('checked', true);
			/*
			var str="你选中的是：\r\n";
			jQuery('[name="nid[]"]:checkbox').each(function(){
				str+=$(this).val()+"\r\n";
			});
			alert(str);
			*/
			jQuery(this).html('全消');
		},function(){
			jQuery('[name="nid[]"]:checkbox').attr('checked', false);
			jQuery(this).html('全选');
		});

		//批量删除
		jQuery('#batch-del').click(function(){
			var ids="";
			var count=0;
			jQuery('[name="nid[]"]:checkbox:checked').each(function(){
				ids+=jQuery(this).val()+",";
				str+=jQuery(this).val()+"\r\n";
				count++;
			});
			var str="已选中"+count+"条公告，确定要删除吗？";
			//alert(str);
			if(ids!="")
			{
				if(confirm(str))
				{
					jQuery.ajax({
						type: 'get',
						url: '<{spUrl c=notice a=batchDel confirm=1}>'+'&ids='+ids,
						success: function(data)
						{
							alert(data);
							jQuery.ajax({
								type: 'get',
								url: encodeURI('<{spUrl c=notice a=queryList}>' + '<{$saveUrl}>'),
								success: function(data, html){jQuery('#datagrid').html(data);},
								error: function(){}
							});
						},
						error: function()
						{
							alert('请求失败');
						}
					});
				}
				else
					return false;
			}
			else
				alert("请选择公告。");
		});
	});
	
	function del(id,title)
	{
		if(title.length>10)
			title = title.substring(0,10)+'...';
		if(!confirm("您正在删除公告【"+title+"】，继续吗？"))
			return false;
		else
			jQuery.ajax({
				type: 'get',
				url: '<{spUrl c=notice a=delete}>' + '&id=' + id,
				success: function (data,html){
					alert(data);
					jQuery.ajax({
						type: 'get',
						url: encodeURI('<{spUrl c=notice a=queryList}>' + '<{$saveUrl}>'),
						success: function (data, html){jQuery('#datagrid').html(data);},
						error: function (){}
					});
				},
				error: function (){alert('请求失败');}
			});
	}
	
</script>
       